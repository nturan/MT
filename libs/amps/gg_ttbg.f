      DOUBLE PRECISION FUNCTION SGG_TTBG(P1, P2, P3, P4, P5)
C  
C FUNCTION GENERATED BY MADGRAPH
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P1,P2,P3,P4,...
C  
C FOR PROCESS : g g  -> t t~ g  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NEXTERNAL,   NCOMB                     
      PARAMETER (NEXTERNAL=5, NCOMB= 32)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P1(0:3),P2(0:3),P3(0:3),P4(0:3),P5(0:3)                   
C  
C LOCAL VARIABLES 
C  
      INTEGER NHEL(NEXTERNAL,NCOMB),NTRY                                         
      DOUBLE PRECISION T
      DOUBLE PRECISION GG_TTBG                                                   
      INTEGER IHEL
      LOGICAL GOODHEL(NCOMB)
      DATA GOODHEL/NCOMB*.FALSE./
      DATA NTRY/0/
      DATA (NHEL(IHEL,  1),IHEL=1,5) / -1, -1, -1, -1, -1/
      DATA (NHEL(IHEL,  2),IHEL=1,5) / -1, -1, -1, -1,  1/
      DATA (NHEL(IHEL,  3),IHEL=1,5) / -1, -1, -1,  1, -1/
      DATA (NHEL(IHEL,  4),IHEL=1,5) / -1, -1, -1,  1,  1/
      DATA (NHEL(IHEL,  5),IHEL=1,5) / -1, -1,  1, -1, -1/
      DATA (NHEL(IHEL,  6),IHEL=1,5) / -1, -1,  1, -1,  1/
      DATA (NHEL(IHEL,  7),IHEL=1,5) / -1, -1,  1,  1, -1/
      DATA (NHEL(IHEL,  8),IHEL=1,5) / -1, -1,  1,  1,  1/
      DATA (NHEL(IHEL,  9),IHEL=1,5) / -1,  1, -1, -1, -1/
      DATA (NHEL(IHEL, 10),IHEL=1,5) / -1,  1, -1, -1,  1/
      DATA (NHEL(IHEL, 11),IHEL=1,5) / -1,  1, -1,  1, -1/
      DATA (NHEL(IHEL, 12),IHEL=1,5) / -1,  1, -1,  1,  1/
      DATA (NHEL(IHEL, 13),IHEL=1,5) / -1,  1,  1, -1, -1/
      DATA (NHEL(IHEL, 14),IHEL=1,5) / -1,  1,  1, -1,  1/
      DATA (NHEL(IHEL, 15),IHEL=1,5) / -1,  1,  1,  1, -1/
      DATA (NHEL(IHEL, 16),IHEL=1,5) / -1,  1,  1,  1,  1/
      DATA (NHEL(IHEL, 17),IHEL=1,5) /  1, -1, -1, -1, -1/
      DATA (NHEL(IHEL, 18),IHEL=1,5) /  1, -1, -1, -1,  1/
      DATA (NHEL(IHEL, 19),IHEL=1,5) /  1, -1, -1,  1, -1/
      DATA (NHEL(IHEL, 20),IHEL=1,5) /  1, -1, -1,  1,  1/
      DATA (NHEL(IHEL, 21),IHEL=1,5) /  1, -1,  1, -1, -1/
      DATA (NHEL(IHEL, 22),IHEL=1,5) /  1, -1,  1, -1,  1/
      DATA (NHEL(IHEL, 23),IHEL=1,5) /  1, -1,  1,  1, -1/
      DATA (NHEL(IHEL, 24),IHEL=1,5) /  1, -1,  1,  1,  1/
      DATA (NHEL(IHEL, 25),IHEL=1,5) /  1,  1, -1, -1, -1/
      DATA (NHEL(IHEL, 26),IHEL=1,5) /  1,  1, -1, -1,  1/
      DATA (NHEL(IHEL, 27),IHEL=1,5) /  1,  1, -1,  1, -1/
      DATA (NHEL(IHEL, 28),IHEL=1,5) /  1,  1, -1,  1,  1/
      DATA (NHEL(IHEL, 29),IHEL=1,5) /  1,  1,  1, -1, -1/
      DATA (NHEL(IHEL, 30),IHEL=1,5) /  1,  1,  1, -1,  1/
      DATA (NHEL(IHEL, 31),IHEL=1,5) /  1,  1,  1,  1, -1/
      DATA (NHEL(IHEL, 32),IHEL=1,5) /  1,  1,  1,  1,  1/
C ----------
C BEGIN CODE
C ----------
      SGG_TTBG = 0d0
      NTRY=NTRY+1
      DO IHEL=1,NCOMB
          IF (GOODHEL(IHEL) .OR. NTRY .LT. 10) THEN
             T=GG_TTBG(P1, P2, P3, P4, P5,NHEL(1,IHEL)) 
             SGG_TTBG = SGG_TTBG + T
              IF (T .GT. 0D0 .AND. .NOT. GOODHEL(IHEL)) THEN
                  GOODHEL(IHEL)=.TRUE.
              ENDIF
          ENDIF
      ENDDO
      SGG_TTBG = SGG_TTBG /  4D0 
      END
       
       
      DOUBLE PRECISION FUNCTION GG_TTBG(P1, P2, P3, P4, P5,NHEL)
C  
C FUNCTION GENERATED BY MADGRAPH
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT IN PHASE SPACE P1,P2,P3,P4,...
C AND HELICITY NHEL(1),NHEL(2),....
C  
C FOR PROCESS : g g  -> t t~ g  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN,    NEXTERNAL       
      PARAMETER (NGRAPHS= 18,NEIGEN=  6,NEXTERNAL=5)    
      DOUBLE PRECISION ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P1(0:3),P2(0:3),P3(0:3),P4(0:3),P5(0:3)                   
      INTEGER NHEL(NEXTERNAL)                                                    
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J
      DOUBLE PRECISION EIGEN_VAL(NEIGEN)
      DOUBLE PRECISION EIGEN_VEC(NGRAPHS,NEIGEN)
      DOUBLE COMPLEX ZTEMP
      DOUBLE COMPLEX AMP(NGRAPHS)
      DOUBLE COMPLEX W1(6)  , W2(6)  , W3(6)  , W4(6)  , W5(6)    
      DOUBLE COMPLEX W6(6)  , W7(6)  , W8(6)  , W9(6)  , W10(6)   
      DOUBLE COMPLEX W11(6) , W12(6) , W13(6) , W14(6) , W15(6)   
      DOUBLE COMPLEX W16(6) , W17(6) , W18(6) , W19(6) , W20(6)   
      DOUBLE COMPLEX W21(6) , W22(6) , W23(6) 
C  
C GLOBAL VARIABLES
C  
      DOUBLE PRECISION  GG(2), G
      COMMON /COUPQCD/ GG,    G
      DOUBLE PRECISION   FMASS(12), FWIDTH(12)
      COMMON /FERMIONS/ FMASS,     FWIDTH
C  
C COLOR DATA
C  
      DATA EIGEN_VAL(1  )/       1.041666666666666666666666666667D-01 /    
      DATA EIGEN_VEC(1  ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(2  ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(3  ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(4  ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(5  ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(6  ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(7  ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(8  ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(9  ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(10 ,1  )/   4.082482904638630163662140124510D-01 /    
      DATA EIGEN_VEC(11 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(12 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(13 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(14 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(15 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(16 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(17 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(18 ,1  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VAL(2  )/       1.562500000000000000000000000000D-01 /    
      DATA EIGEN_VEC(1  ,2  )/   1.710454626357624353875531684696D-02 /    
      DATA EIGEN_VEC(2  ,2  )/  -3.446906685851524659559381347999D-01 /    
      DATA EIGEN_VEC(3  ,2  )/   1.710454626357624353875531684696D-02 /    
      DATA EIGEN_VEC(4  ,2  )/   3.446906685851524659559381347999D-01 /    
      DATA EIGEN_VEC(5  ,2  )/   3.617952148487287094946934516469D-01 /    
      DATA EIGEN_VEC(6  ,2  )/   1.710454626357624353875531684696D-02 /    
      DATA EIGEN_VEC(7  ,2  )/  -3.446906685851524659559381347999D-01 /    
      DATA EIGEN_VEC(8  ,2  )/  -3.446906685851524659559381347999D-01 /    
      DATA EIGEN_VEC(9  ,2  )/  -1.710454626357624353875531684696D-02 /    
      DATA EIGEN_VEC(10 ,2  )/  -3.617952148487287094946934516469D-01 /    
      DATA EIGEN_VEC(11 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(12 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(13 ,2  )/  -3.617952148487287094946934516469D-01 /    
      DATA EIGEN_VEC(14 ,2  )/  -3.617952148487287094946934516469D-01 /    
      DATA EIGEN_VEC(15 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(16 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(17 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(18 ,2  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VAL(3  )/       1.562500000000000000000000000000D-01 /    
      DATA EIGEN_VEC(1  ,3  )/  -4.078898149792218661215294300272D-01 /    
      DATA EIGEN_VEC(2  ,3  )/  -2.187578790740741607171486803104D-01 /    
      DATA EIGEN_VEC(3  ,3  )/  -4.078898149792218661215294300272D-01 /    
      DATA EIGEN_VEC(4  ,3  )/   2.187578790740741607171486803104D-01 /    
      DATA EIGEN_VEC(5  ,3  )/  -1.891319359051477054043807497168D-01 /    
      DATA EIGEN_VEC(6  ,3  )/  -4.078898149792218661215294300272D-01 /    
      DATA EIGEN_VEC(7  ,3  )/  -2.187578790740741607171486803104D-01 /    
      DATA EIGEN_VEC(8  ,3  )/  -2.187578790740741607171486803104D-01 /    
      DATA EIGEN_VEC(9  ,3  )/   4.078898149792218661215294300272D-01 /    
      DATA EIGEN_VEC(10 ,3  )/   1.891319359051477054043807497168D-01 /    
      DATA EIGEN_VEC(11 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(12 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(13 ,3  )/   1.891319359051477054043807497168D-01 /    
      DATA EIGEN_VEC(14 ,3  )/   1.891319359051477054043807497168D-01 /    
      DATA EIGEN_VEC(15 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(16 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(17 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(18 ,3  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VAL(4  )/       6.250000000000000000000000000000D-01 /    
      DATA EIGEN_VEC(1  ,4  )/   3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(2  ,4  )/  -3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(3  ,4  )/  -1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(4  ,4  )/  -1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(5  ,4  )/   1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(6  ,4  )/   3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(7  ,4  )/  -3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(8  ,4  )/   1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(9  ,4  )/   1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(10 ,4  )/  -1.825741858350553711523232609336D-01 /    
      DATA EIGEN_VEC(11 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(12 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(13 ,4  )/   3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(14 ,4  )/   3.651483716701107423046465218672D-01 /    
      DATA EIGEN_VEC(15 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(16 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(17 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(18 ,4  )/   0.000000000000000000000000000000D+00 /    
      DATA EIGEN_VAL(5  )/       2.250000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(1  ,5  )/   7.571014101963476692938977032506D-03 /    
      DATA EIGEN_VEC(2  ,5  )/  -2.201925536301098003147403895987D-01 /    
      DATA EIGEN_VEC(3  ,5  )/  -1.442713643860853746455139340549D-01 /    
      DATA EIGEN_VEC(4  ,5  )/   6.835017514206094897628747851122D-02 /    
      DATA EIGEN_VEC(5  ,5  )/   7.592118924402442566922645554372D-02 /    
      DATA EIGEN_VEC(6  ,5  )/  -7.571014101963476692938977032506D-03 /    
      DATA EIGEN_VEC(7  ,5  )/   2.201925536301098003147403895987D-01 /    
      DATA EIGEN_VEC(8  ,5  )/   6.835017514206094897628747851122D-02 /    
      DATA EIGEN_VEC(9  ,5  )/  -1.442713643860853746455139340549D-01 /    
      DATA EIGEN_VEC(10 ,5  )/   7.592118924402442566922645554372D-02 /    
      DATA EIGEN_VEC(11 ,5  )/  -1.514202820392695338587795406501D-02 /    
      DATA EIGEN_VEC(12 ,5  )/   4.403851072602196006294807791973D-01 /    
      DATA EIGEN_VEC(13 ,5  )/   2.126215395281463236218014125662D-01 /    
      DATA EIGEN_VEC(14 ,5  )/  -2.126215395281463236218014125662D-01 /    
      DATA EIGEN_VEC(15 ,5  )/  -4.252430790562926472436028251323D-01 /    
      DATA EIGEN_VEC(16 ,5  )/   4.252430790562926472436028251323D-01 /    
      DATA EIGEN_VEC(17 ,5  )/   1.514202820392695338587795406501D-02 /    
      DATA EIGEN_VEC(18 ,5  )/  -4.403851072602196006294807791973D-01 /    
      DATA EIGEN_VAL(6  )/       2.250000000000000000000000000000D+00 /    
      DATA EIGEN_VEC(1  ,6  )/  -2.498853331939829360311280065343D-01 /    
      DATA EIGEN_VEC(2  ,6  )/   1.183859760522808689645071239340D-01 /    
      DATA EIGEN_VEC(3  ,6  )/  -4.371127029807066034037919555474D-03 /    
      DATA EIGEN_VEC(4  ,6  )/   1.271282301118950010325829630449D-01 /    
      DATA EIGEN_VEC(5  ,6  )/  -1.227571030820879349985450434894D-01 /    
      DATA EIGEN_VEC(6  ,6  )/   2.498853331939829360311280065343D-01 /    
      DATA EIGEN_VEC(7  ,6  )/  -1.183859760522808689645071239340D-01 /    
      DATA EIGEN_VEC(8  ,6  )/   1.271282301118950010325829630449D-01 /    
      DATA EIGEN_VEC(9  ,6  )/  -4.371127029807066034037919555475D-03 /    
      DATA EIGEN_VEC(10 ,6  )/  -1.227571030820879349985450434894D-01 /    
      DATA EIGEN_VEC(11 ,6  )/   4.997706663879658720622560130687D-01 /    
      DATA EIGEN_VEC(12 ,6  )/  -2.367719521045617379290142478679D-01 /    
      DATA EIGEN_VEC(13 ,6  )/   1.314993571417020670666208826004D-01 /    
      DATA EIGEN_VEC(14 ,6  )/  -1.314993571417020670666208826004D-01 /    
      DATA EIGEN_VEC(15 ,6  )/  -2.629987142834041341332417652008D-01 /    
      DATA EIGEN_VEC(16 ,6  )/   2.629987142834041341332417652008D-01 /    
      DATA EIGEN_VEC(17 ,6  )/  -4.997706663879658720622560130687D-01 /    
      DATA EIGEN_VEC(18 ,6  )/   2.367719521045617379290142478679D-01 /    
C ----------
C BEGIN CODE
C ----------
      CALL VXXXXX(P1  , ZERO,NHEL(1  ),-1,W1  )                            
      CALL VXXXXX(P2  , ZERO,NHEL(2  ),-1,W2  )                            
      CALL OXXXXX(P3  ,FMASS(11 ),NHEL(3  ), 1,W3  )                       
      CALL IXXXXX(P4  ,FMASS(11 ),NHEL(4  ),-1,W4  )                       
      CALL VXXXXX(P5  , ZERO,NHEL(5  ), 1,W5  )                            
      CALL FVOXXX(W3  ,W2  ,GG,FMASS(11 ),FWIDTH(11 ),W6  )                
      CALL JIOXXX(W4  ,W6  ,GG,ZERO,ZERO,W7  )                             
      CALL GGGXXX(W5  ,W1  ,W7  ,G,AMP(1  ))                               
      CALL FVIXXX(W4  ,W1  ,GG,FMASS(11 ),FWIDTH(11 ),W8  )                
      CALL JGGXXX(W5  ,W2  ,G,W9  )                                        
      CALL IOVXXX(W8  ,W3  ,W9  ,GG,AMP(2  ))                              
      CALL FVOXXX(W3  ,W5  ,GG,FMASS(11 ),FWIDTH(11 ),W10 )                
      CALL IOVXXX(W8  ,W10 ,W2  ,GG,AMP(3  ))                              
      CALL FVOXXX(W6  ,W1  ,GG,FMASS(11 ),FWIDTH(11 ),W11 )                
      CALL IOVXXX(W4  ,W11 ,W5  ,GG,AMP(4  ))                              
      CALL IOVXXX(W8  ,W6  ,W5  ,GG,AMP(5  ))                              
      CALL FVIXXX(W4  ,W2  ,GG,FMASS(11 ),FWIDTH(11 ),W12 )                
      CALL JGGXXX(W5  ,W1  ,G,W13 )                                        
      CALL IOVXXX(W12 ,W3  ,W13 ,GG,AMP(6  ))                              
      CALL FVOXXX(W3  ,W1  ,GG,FMASS(11 ),FWIDTH(11 ),W14 )                
      CALL JIOXXX(W4  ,W14 ,GG,ZERO,ZERO,W15 )                             
      CALL GGGXXX(W5  ,W2  ,W15 ,G,AMP(7  ))                               
      CALL IOVXXX(W12 ,W10 ,W1  ,GG,AMP(8  ))                              
      CALL FVOXXX(W14 ,W2  ,GG,FMASS(11 ),FWIDTH(11 ),W16 )                
      CALL IOVXXX(W4  ,W16 ,W5  ,GG,AMP(9  ))                              
      CALL IOVXXX(W12 ,W14 ,W5  ,GG,AMP(10 ))                              
      CALL JIOXXX(W4  ,W3  ,GG,ZERO,ZERO,W17 )                             
      CALL GGGXXX(W13 ,W2  ,W17 ,G,AMP(11 ))                               
      CALL GGGXXX(W1  ,W9  ,W17 ,G,AMP(12 ))                               
      CALL JGGXXX(W1  ,W2  ,G,W18 )                                        
      CALL FVIXXX(W4  ,W18 ,GG,FMASS(11 ),FWIDTH(11 ),W19 )                
      CALL IOVXXX(W19 ,W3  ,W5  ,GG,AMP(13 ))                              
      CALL FVOXXX(W3  ,W18 ,GG,FMASS(11 ),FWIDTH(11 ),W20 )                
      CALL IOVXXX(W4  ,W20 ,W5  ,GG,AMP(14 ))                              
      CALL GGGXXX(W5  ,W17 ,W18 ,G,AMP(15 ))                               
      CALL JGGGXX(W1  ,W2  ,W5  ,G,W21 )                                   
      CALL IOVXXX(W4  ,W3  ,W21 ,GG,AMP(16 ))                              
      CALL JGGGXX(W5  ,W1  ,W2  ,G,W22 )                                   
      CALL IOVXXX(W4  ,W3  ,W22 ,GG,AMP(17 ))                              
      CALL JGGGXX(W2  ,W5  ,W1  ,G,W23 )                                   
      CALL IOVXXX(W4  ,W3  ,W23 ,GG,AMP(18 ))                              
      GG_TTBG = 0.D0 
      DO I = 1, NEIGEN
          ZTEMP = (0.D0,0.D0)
          DO J = 1, NGRAPHS
              ZTEMP = ZTEMP + EIGEN_VEC(J,I)*AMP(J)
          ENDDO
          GG_TTBG =GG_TTBG+ZTEMP*EIGEN_VAL(I)*CONJG(ZTEMP) 
      ENDDO
C      CALL GAUGECHECK(AMP,ZTEMP,EIGEN_VEC,EIGEN_VAL,NGRAPHS,NEIGEN)
      END
